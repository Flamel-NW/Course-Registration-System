(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[531],{34687:function(U){U.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",icon:"icon___rzGKO"}},19319:function(U,j,s){"use strict";s.r(j);var Q=s(18106),M=s(60561),X=s(34792),P=s(48086),o=s(39428),d=s(11849),D=s(3182),T=s(2824),q=s(17462),R=s(76772),W=s(71390),E=s(11595),y=s(89366),x=s(2603),N=s(70469),Z=s(24528),C=s(67294),l=s(25377),F=s(34687),m=s.n(F),a=s(85893),$=function(O){var p=O.content;return(0,a.jsx)(R.Z,{style:{marginBottom:24},message:p,type:"error",showIcon:!0})},z=function(){var O=(0,C.useState)({}),p=(0,T.Z)(O,2),b=p[0],G=p[1],H=(0,C.useState)("student"),B=(0,T.Z)(H,2),c=B[0],J=B[1],S=(0,l.tT)("@@initialState"),v=S.initialState,A=S.setInitialState,i=(0,l.YB)(),ee=function(){var g=(0,D.Z)((0,o.Z)().mark(function _(){var r,u;return(0,o.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v==null||(r=v.fetchUserInfo)===null||r===void 0?void 0:r.call(v);case 2:if(u=t.sent,!u){t.next=6;break}return t.next=6,A(function(f){return(0,d.Z)((0,d.Z)({},f),{},{currentUser:u})});case 6:case"end":return t.stop()}},_)}));return function(){return g.apply(this,arguments)}}(),Y=function(){var g=(0,D.Z)((0,o.Z)().mark(function _(r,u){var n,t,f,h,L,I,K;return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=null,u!=="student"){e.next=12;break}if(f=parseInt((t=r.username)===null||t===void 0?void 0:t.slice(-6)),!(r.username[0]!=="S"||isNaN(f))){e.next=7;break}return P.ZP.error("Student username should be S******!"),e.abrupt("return");case 7:return e.next=9,(0,E.kW)({id:f,password:r.password});case 9:n=e.sent,e.next=26;break;case 12:if(u!=="teacher"){e.next=22;break}if(L=parseInt((h=r.username)===null||h===void 0?void 0:h.slice(-6)),!(r.username[0]!=="T"||isNaN(L))){e.next=17;break}return P.ZP.error("Student username should be T******!"),e.abrupt("return");case 17:return e.next=19,(0,E.tz)({id:L,password:r.password});case 19:n=e.sent,e.next=26;break;case 22:if(u!=="admin"){e.next=26;break}return e.next=25,(0,E.$g)({id:r.username,password:r.password});case 25:n=e.sent;case 26:if(n.code!==0){e.next=38;break}return e.next=29,(0,E.lR)();case 29:return I=e.sent,e.next=32,A(function(V){return(0,d.Z)((0,d.Z)({},V),{},{user:n.data,currentUserType:c,status:I.data})});case 32:localStorage.setItem("user",JSON.stringify(n.data)),localStorage.setItem("type",c),localStorage.setItem("status",JSON.stringify(I.data)),l.m8.push("/"),e.next=39;break;case 38:G((0,d.Z)((0,d.Z)({},b),{},{status:"error"}));case 39:return e.abrupt("return");case 42:e.prev=42,e.t0=e.catch(0),K=i.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),P.ZP.error(K);case 46:case"end":return e.stop()}},_,null,[[0,42]])}));return function(r,u){return g.apply(this,arguments)}}(),w=b.status;return(0,a.jsxs)("div",{className:m().container,children:[(0,a.jsx)("div",{className:m().lang,"data-lang":!0,children:l.pD&&(0,a.jsx)(l.pD,{})}),(0,a.jsx)("div",{className:m().content,children:(0,a.jsxs)(N.U,{logo:(0,a.jsx)("img",{id:"logo",src:"/jlu.png"}),title:"\u6559\u52A1\u901A",subTitle:i.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},actions:[],onFinish:function(){var g=(0,D.Z)((0,o.Z)().mark(function _(r){return(0,o.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Y(r,c);case 2:case"end":return n.stop()}},_)}));return function(_){return g.apply(this,arguments)}}(),children:[(0,a.jsxs)(M.Z,{activeKey:c,onChange:J,children:[(0,a.jsx)(M.Z.TabPane,{tab:i.formatMessage({id:"pages.login.studentLogin.tab",defaultMessage:"\u5B66\u751F\u767B\u5F55"})},"student"),(0,a.jsx)(M.Z.TabPane,{tab:i.formatMessage({id:"pages.login.teacherLogin.tab",defaultMessage:"\u6559\u5E08\u767B\u5F55"})},"teacher"),(0,a.jsx)(M.Z.TabPane,{tab:i.formatMessage({id:"pages.login.adminLogin.tab",defaultMessage:"\u7BA1\u7406\u5458\u767B\u5F55"})},"admin")]}),w==="error"&&(0,a.jsx)($,{content:i.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z.Z,{name:"username",fieldProps:{size:"large",prefix:(0,a.jsx)(y.Z,{className:m().prefixIcon})},placeholder:i.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D"}),rules:[{required:!0,message:(0,a.jsx)(l._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,a.jsx)(Z.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,a.jsx)(x.Z,{className:m().prefixIcon})},placeholder:i.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801"}),rules:[{required:!0,message:(0,a.jsx)(l._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]})]})}),(0,a.jsx)(W.Z,{})]})};j.default=z}}]);
